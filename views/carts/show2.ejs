<%- include ('../partials/header') %>

<%	const total = products.reduce((acc, product) => { %>
  <%		return acc + product.productDetails.price * product.quantity; %>
<%	}, 0); %>



    <div id="cart" class="container">
        <div class="columns">
          <div class="column"></div>
          <div class="column is-four-fifths">
            <h3 class="subtitle"><b>Shopping Cart</b></h3>
            <div> 
            <%  for (let product of products) { %>
                <div class="cart-item message">
                  <h3 class="subtitle">   <%= product.productDetails.title %></h3>
                  <h4> <%= product.size %></h4>
                  <h4> <%= product.color %></h4>
                  <div class="cart-right">
                    <div>
                      <%= product.productDetails.price %> X  <%=  product.quantity %> = 
                    </div>
                    <div class="price is-size-4">
                      <%= product.productDetails.price  * product.quantity  %>
                    </div>
                    <div class="remove"> 
                      <form method="POST" action="/cart/products/edit">
                        <input hidden value="<%= product.id %>" name="productId">
                        <input hidden value="<%= product.size %>" name="productSize">
                        <input hidden value="<%= product.color %>" name="productColor">
                        <button class="button is-warning">                  
                          <span class="icon is-small">
                            <i class="fas fa-plus"></i>
                          </span>
                        </button>
                      </form>
                    </div>


                    <div class="remove"> 
                      <form method="POST" action="/cart/products/delete">
                        <input hidden value="<%= product.id %>" name="productId">
                        <input hidden value="<%= product.size %>" name="productSize">
                        <input hidden value="<%= product.color %>" name="productColor">
                        <button class="button is-danger">                  
                          <span class="icon is-small">
                            <i class="fas fa-times"></i>
                          </span>
                        </button>
                      </form>
                    </div>
                  </div>
                </div> 
              
            <%  } %>
            </div>
            <div class="total message is-info">
              <div class="message-header">
                Total
              </div>
              <h1 class="title"> <%= total %> </h1>
              <button class="button is-primary">Buy</button>
            </div>
          </div>
          <div class="column"></div>
        </div>
      </div>



<%- include ("../partials/footer") %>